server {
    listen 9090;
    server_name localhost;
    root /var/www/dist;
    index index.html index.htm index.php;

    location ~* \.(css|js|png|jpg|jpeg|gif|gz|svg|mp4|ogg|ogv|webm|htc|xml|woff)$ {
        add_header Cache-Control max-age=604800;
    }

    location / {
        if ($uri ~* aws-sdk-2.1657.0.min.js) {
            rewrite ^.*$ /home/wwwroot/test-mesas-vue/aws-sdk-2.1657.0.min.js last;
        }
        root /var/www/dist;
        index  index.html index.htm;
        try_files $uri $uri/ /index.html;
        error_log /var/log/nginx/ms_test_error.log;
        access_log /var/log/nginx/ms_test_access.log;
        keepalive_timeout 300s;
        send_timeout 300s;
        proxy_read_timeout 300s;
        fastcgi_connect_timeout 300s;
        fastcgi_send_timeout 300s;
        fastcgi_read_timeout 300s;
    }


    location /api {
        rewrite ^/api(.*)$ $1 break;
        #proxy_pass http://47.95.217.189::8080;
        #proxy_set_header Host test-api.mesas.com;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        #proxy_redirect default;
        add_header Access-Control-Allow-Origin *;
        add_header Access-Control-Allow-Headers X-Requested-With;
        add_header Access-Control-Allow-Methods GET,POST,OPTIONS;
        keepalive_timeout 300s;
        send_timeout 300s;
        proxy_read_timeout 300s;
        fastcgi_connect_timeout 300s;
        fastcgi_send_timeout 300s;
        fastcgi_read_timeout 300s;
    }

    location /spec {
        # rewrite ^/api(.*)$ $1 break;
        #proxy_pass http://47.95.217.189::8080;
        #proxy_set_header Host mess.test.api.oaepublish.com;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        #proxy_redirect default;
        add_header Access-Control-Allow-Origin *;
        add_header Access-Control-Allow-Headers X-Requested-With;
        add_header Access-Control-Allow-Methods GET,POST,OPTIONS;
    }

    location ~ /\.ht {
        deny all;
    }
}